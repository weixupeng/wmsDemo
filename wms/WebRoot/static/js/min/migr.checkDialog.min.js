(function($){
var $target=null;
$.extend({
notifyCheckDialog:function(state){
$.pdialog.closeCurrent();
var callback=$target.attr('callback');
if(callback){
if(!$.isFunction(callback))callback=eval('('+callback+')');
callback($target,state);}}});
$.fn.extend({
checkDialog:function(){
return this.each(function(){
var $this=$(this)
$this.click(function(event){
$target=$this;
var $p=$this.parents(".unitBox:first");
var beforeCall=$target.attr('beforeCall');
var beforeCallStr=beforeCall;
if(beforeCall){
if(!$.isFunction(beforeCall))beforeCall=eval('('+beforeCall+')');
if(!beforeCall(this)){
return false;}}
var title=$this.attr("title")||$this.text();
var rel=$this.attr("rel")||"_blank";
var options={};
var w=$this.attr("width");
var h=$this.attr("height");
if(w){
options.width=w;}else{
options.width=450;}
if(h){
options.height=h;}else{
options.height=250;}
options.max=eval($this.attr("max")||"false");
options.mask=eval($this.attr("mask")||"true");
options.maxable=eval($this.attr("maxable")||"true");
options.minable=eval($this.attr("minable")||"false");
options.fresh=eval($this.attr("fresh")||"true");
options.resizable=eval($this.attr("resizable")||"true");
options.drawable=eval($this.attr("drawable")||"true");
options.close=eval($this.attr("close")||"");
options.param=$this.attr("param")||"";
var url=$this.attr("url")||$("#approveUrl",$p).val();
Bird.debug(url);
if(!url.isFinishedTm()){
alertMsg.error($this.attr("warn")||Bird.msg("alertSelectMsg"));
return false;}
if(beforeCallStr=='migr.beforApprove'){
alertMsg.confirm("确定已保存单据？修改数据后未保存单据会导致数据更新无效！",{
okCall:function(){
$.pdialog.open(url,rel,title,options);}});}else{
$.pdialog.open(url,rel,title,options);}
return false;});});},
dblCheckDialog:function(){
return this.each(function(){
$(this).dblclick(function(event){
var $this=$(this);
$target=$this;
var $p=$this.parents(".unitBox:first");
var beforeCall=$target.attr('beforeCall');
if(beforeCall){
if(!$.isFunction(beforeCall))beforeCall=eval('('+beforeCall+')');
if(!beforeCall(this)){
return false;}}
var title=$this.attr("title")||$this.text();
var rel=$this.attr("rel")||"_blank";
var options={};
var w=$this.attr("width");
var h=$this.attr("height");
if(w){
options.width=w;}else{
options.width=450;}
if(h){
options.height=h;}else{
options.height=250;}
options.max=eval($this.attr("max")||"true");
options.mask=eval($this.attr("mask")||"false");
options.maxable=eval($this.attr("maxable")||"true");
options.minable=eval($this.attr("minable")||"true");
options.fresh=eval($this.attr("fresh")||"true");
options.resizable=eval($this.attr("resizable")||"true");
options.drawable=eval($this.attr("drawable")||"true");
options.close=eval($this.attr("close")||"");
options.restore=eval($this.attr("restore")||"false");
options.param=$this.attr("param")||"";
var url=$this.attr("url")||$("#approveUrl",$p).val();
Bird.debug(url);
if(!url.isFinishedTm()){
alertMsg.error($this.attr("warn")||Bird.msg("alertSelectMsg"));
return false;}
$.pdialog.open(url,rel,title,options);
return false;});});}});})(jQuery);

